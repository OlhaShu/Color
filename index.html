<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–ª—ñ—Ä–Ω–∏–π –ú–∞–π—Å—Ç–µ—Ä - –¢—Ä–µ–Ω–∞–∂–µ—Ä –≥–∞—Ä–º–æ–Ω—ñ–π</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
                
        * {
            font-family: 'Inter', sans-serif;
        }
                
        body {
            overflow-x: hidden;
            /* –ó–ú–Ü–ù–ê –î–õ–Ø –ó–û–†–£: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞—Ç–∏—á–Ω–∏–π, –º'—è–∫–∏–π, —Ç–µ–º–Ω–æ-—Å—ñ—Ä–∏–π —Ñ–æ–Ω –∑–∞–º—ñ—Å—Ç—å –∞–Ω—ñ–º–æ–≤–∞–Ω–æ–≥–æ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∞, —â–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ –Ω–∞–ø—Ä—É–≥—É –æ—á–µ–π —Ç–∞ —É–Ω–∏–∫–Ω—É—Ç–∏ –º–µ—Ä–µ—Ö—Ç—ñ–Ω–Ω—è. */
            background-color: #1A202C; 
        }
                
        /* –í–ò–î–ê–õ–ï–ù–ù–Ø: –£—Å—ñ —Å—Ç–∏–ª—ñ —Ç–∞ –∞–Ω—ñ–º–∞—Ü—ñ—ó .gradient-bg —Ç–∞ keyframes, —è–∫—ñ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å –≤—Ç–æ–º—É –æ—á–µ–π */
        
        .glass-card {
            /* –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –¥–æ —Ç–µ–º–Ω–æ–≥–æ —Ñ–æ–Ω—É: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø—Ä–æ–∑–æ—Ä–∏–π —Ç–µ–º–Ω–æ-—Å—ñ—Ä–∏–π, —â–æ–± –µ–ª–µ–º–µ–Ω—Ç–∏ –±—É–ª–∏ –ø–æ–º—ñ—Ç–Ω—ñ—à–∏–º–∏, –∞–ª–µ –±–µ–∑ —Å–∏–ª—å–Ω–æ–≥–æ –±–ª–∏—Å–∫—É –±—ñ–ª–æ–≥–æ. */
            background: rgba(45, 55, 72, 0.6); 
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
                
        .glass-card:hover {
            background: rgba(45, 55, 72, 0.8);
            transform: translateY(-2px); /* –ó–º–µ–Ω—à–µ–Ω–æ –ø—ñ–¥–π–æ–º, —â–æ–± –±—É—Ç–∏ –º–µ–Ω—à –∞–≥—Ä–µ—Å–∏–≤–Ω–∏–º */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
                
        .color-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
                
        .color-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(255,255,255,0.2) 50%, transparent 100%);
            transform: translateX(-100%) translateY(-100%);
            transition: transform 0.6s;
        }
                
        .color-card:hover::after {
            transform: translateX(100%) translateY(100%);
        }
                
        .color-card:hover {
            transform: scale(1.08) translateY(-4px);
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.4);
            z-index: 10;
        }
                
        .btn-primary {
            /* –ó–º—ñ–Ω–∞ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∞ –∫–Ω–æ–ø–∫–∏: –ø—Ä–∏–≥–ª—É—à–µ–Ω–∏–π –≥—Ä–∞–¥—ñ—î–Ω—Ç, —è–∫–∏–π –∫—Ä–∞—â–µ –≤–ø–∏—Å—É—î—Ç—å—Å—è –≤ —Ç–µ–º–Ω—É —Ç–µ–º—É */
            background: linear-gradient(135deg, #4A5568 0%, #2D3748 100%);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
                
        .btn-primary::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
                
        .btn-primary:hover::before {
            transform: translateX(100%);
        }
                
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
        }
                
        .color-info-overlay {
            background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.95) 100%);
        }
                
        .role-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.9);
            color: #1a202c;
            margin-top: 0.5rem;
        }
                
        .usage-bar {
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.3);
            overflow: hidden;
            margin-top: 0.5rem;
        }
                
        .usage-fill {
            height: 100%;
            /* –ó–∞–ª–∏—à–∞—î–º–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∞–∫—Ü–µ–Ω—Ç–Ω–∏–π –≥—Ä–∞–¥—ñ—î–Ω—Ç –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è, –∞–ª–µ –≤—ñ–Ω –≤–∏–º–∞–≥–∞—Ç–∏–º–µ —É–≤–∞–≥–∏ */
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
                
        input[type="color"] {
            appearance: none;
            width: 100%;
            height: 70px;
            background: none;
            border: none;
            cursor: pointer;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
                
        input[type="color"]:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
        }
                
        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }
                
        input[type="color"]::-webkit-color-swatch {
            border: none;
            border-radius: 16px;
        }
                
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
                
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
                
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
                
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
                
        .info-panel {
            /* –ü—Ä–∏—Å—Ç–æ—Å–æ–≤—É—î–º–æ –ø–∞–Ω–µ–ª—å –¥–æ —Ç–µ–º–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É */
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 100%);
            border-left: 4px solid #667eea; /* –ê–∫—Ü–µ–Ω—Ç–Ω–∏–π –∫–æ–ª—ñ—Ä */
            padding: 1rem;
            border-radius: 12px;
            margin-top: 1rem;
        }
        
        .harmony-type-btn.selected {            
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.8), 0 0 10px #764ba2; /* –ó–º—ñ–Ω–∞ –∞–∫—Ü–µ–Ω—Ç–Ω–æ—ó —Ç—ñ–Ω—ñ */
            border-color: transparent;        
        }    
    </style>
</head>
<body class="min-h-screen"> <!-- –ó–ú–Ü–ù–ê: –≤–∏–¥–∞–ª—è—î–º–æ –∫–ª–∞—Å gradient-bg -->
    <div class="container mx-auto px-4 py-8 max-w-7xl relative z-10">
                <!-- Header -->
        <header class="text-center mb-12 fade-in">
            <div class="inline-flex items-center gap-4 mb-4 bg-white/15 backdrop-blur-md px-8 py-4 rounded-full shadow-2xl">
                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
                </svg>
                <h1 class="text-5xl font-black text-white tracking-tight">–ö–æ–ª—ñ—Ä–Ω–∏–π –ú–∞–π—Å—Ç–µ—Ä</h1>
            </div>
            <p class="text-white/95 text-xl font-medium max-w-3xl mx-auto">–î–æ—Å–ª—ñ–¥–∂—É–π—Ç–µ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—é –∫–æ–ª—å–æ—Ä—É —á–µ—Ä–µ–∑ –µ–º–æ—Ü—ñ—ó, –∫—ñ–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ —Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂—ñ–≤</p>
            <p class="text-white/70 text-sm mt-2">–ó –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –¥–ª—è –≤—Å—ñ—Ö</p>
        </header>

        <!-- Categories -->
        <div class="glass-card rounded-3xl p-6 mb-8 fade-in">
            <div class="flex flex-wrap justify-center gap-4" id="categories"></div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid lg:grid-cols-3 gap-8">
                        <!-- Left Column: Color Selection -->
            <div class="lg:col-span-2 space-y-8">
                                <!-- Color Items -->
                <div class="glass-card rounded-3xl p-8 fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-3xl font-bold text-white" id="items-title">–û–±–µ—Ä—ñ—Ç—å –µ–º–æ—Ü—ñ—é</h2>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-5" id="color-items"></div>
                </div>

                <!-- Harmony Palette with Usage Ratios -->
                <div class="glass-card rounded-3xl p-8 fade-in">
                    <h2 class="text-3xl font-bold text-white mb-6">–ì–∞—Ä–º–æ–Ω—ñ–π–Ω–∞ –ø–∞–ª—ñ—Ç—Ä–∞</h2>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-5" id="harmony-palette"></div>
                                        <div class="info-panel mt-6">
                        <h3 class="text-white font-bold text-lg mb-3">üìä –ü—Ä–∞–≤–∏–ª–æ 60-30-10</h3>
                        <p class="text-white/90 text-sm mb-4" id="harmony-description"></p>
                        <div class="space-y-3" id="usage-guide"></div>
                    </div>
                </div>

                <!-- Design Examples -->
                <div class="glass-card rounded-3xl p-8 fade-in">
                    <h2 class="text-3xl font-bold text-white mb-6">–ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</h2>
                    <div class="grid md:grid-cols-3 gap-5" id="design-examples"></div>
                </div>

                <!-- Accessibility Info -->
                <div class="glass-card rounded-3xl p-8 fade-in">
                    <h2 class="text-3xl font-bold text-white mb-6">‚ôø –î–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –∫–æ–ª—å–æ—Ä—ñ–≤</h2>
                    <div id="accessibility-info"></div>
                </div>
            </div>

            <!-- Right Column: Controls -->
            <div class="space-y-6">
                                <!-- Base Color -->
                <div class="glass-card rounded-3xl p-6 fade-in">
                    <h2 class="text-2xl font-bold text-white mb-4">–ë–∞–∑–æ–≤–∏–π –∫–æ–ª—ñ—Ä</h2>
                    <div class="space-y-4">
                        <div class="relative h-56 rounded-2xl overflow-hidden cursor-pointer group shadow-2xl" id="base-color-display">
                            <div class="absolute inset-0 color-info-overlay opacity-0 group-hover:opacity-100 transition-opacity duration-300 p-5 flex flex-col justify-end text-white">
                                <p class="text-sm font-semibold mb-3">üñ±Ô∏è –ö–ª—ñ–∫–Ω—ñ—Ç—å –¥–ª—è –∑–º—ñ–Ω–∏</p>
                                <div class="text-sm space-y-2" id="color-info"></div>
                            </div>
                        </div>
                        <input type="color" id="color-picker" class="w-full">
                        <div class="text-center">
                            <p class="text-3xl font-mono font-black text-white mb-1" id="color-hex"></p>
                            <p class="text-sm text-white/80" id="color-hsl"></p>
                        </div>
                    </div>
                </div>

                <!-- Harmony Type -->
                <div class="glass-card rounded-3xl p-6 fade-in">
                    <h2 class="text-2xl font-bold text-white mb-4">–¢–∏–ø –≥–∞—Ä–º–æ–Ω—ñ—ó</h2>
                    <div class="space-y-3" id="harmony-types"></div>
                </div>

                <!-- Psychology Insight -->
                <div class="glass-card rounded-3xl p-6 fade-in">
                    <h3 class="text-xl font-bold text-white mb-3">üß† –ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è</h3>
                    <div class="text-sm text-white/90 leading-relaxed" id="psychology-info"></div>
                </div>

                <!-- Quick Tips -->
                <div class="glass-card rounded-3xl p-6 fade-in">
                    <h3 class="text-xl font-bold text-white mb-3">üí° –®–≤–∏–¥–∫—ñ –ø—ñ–¥–∫–∞–∑–∫–∏</h3>
                    <ul class="text-sm text-white/90 space-y-2 leading-relaxed">
                        <li>‚Ä¢ –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –∫–æ–ª—ñ—Ä —â–æ–± —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ HEX</li>
                        <li>‚Ä¢ –ù–∞–≤–µ–¥—ñ—Ç—å –∫—É—Ä—Å–æ—Ä –¥–ª—è –¥–µ—Ç–∞–ª–µ–π</li>
                        <li>‚Ä¢ –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–π—Ç–µ –∑ –≥–∞—Ä–º–æ–Ω—ñ—è–º–∏</li>
                        <li>‚Ä¢ –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-8 right-8 bg-white text-gray-800 px-6 py-4 rounded-2xl shadow-2xl transform translate-y-32 transition-transform duration-300 z-50 opacity-0">
        <p class="font-bold" id="toast-message"></p>
    </div>

    <script>
        // --- State Management ---
        let state = {
            category: 'emotions',
            selectedItem: '–ü—Ä–∏—Å—Ç—Ä–∞—Å—Ç—å',
            baseColor: '#FF6B6B',
            harmonyType: 'complementary'
        };

        // Utility to update state and re-render
        const setState = (newState) => {
            state = { ...state, ...newState };
            renderApp();
        };

        // --- Data Definitions ---
        const data = {
            categories: {
                emotions: { name: '–ï–º–æ—Ü—ñ—ó', title: '–û–±–µ—Ä—ñ—Ç—å –µ–º–æ—Ü—ñ—é' },
                moods: { name: '–ö—ñ–Ω–æ-–°—Ü–µ–Ω–∏', title: '–û–±–µ—Ä—ñ—Ç—å –∫—ñ–Ω–æ-–Ω–∞—Å—Ç—Ä—ñ–π' },
                characters: { name: '–ü–µ—Ä—Å–æ–Ω–∞–∂—ñ', title: '–û–±–µ—Ä—ñ—Ç—å –∞—Ä—Ö–µ—Ç–∏–ø' }
            },
            emotions: [
                { name: '–†–∞–¥—ñ—Å—Ç—å', color: '#FFD93D', icon: '‚òÄÔ∏è', desc: '–û–ø—Ç–∏–º—ñ–∑–º —Ç–∞ –µ–Ω–µ—Ä–≥—ñ—è', rationale: '–ñ–æ–≤—Ç–∏–π —Å—Ç–∏–º—É–ª—é—î —Å–µ—Ä–æ—Ç–æ–Ω—ñ–Ω - –≥–æ—Ä–º–æ–Ω —â–∞—Å—Ç—è. –ê—Å–æ—Ü—ñ—é—î—Ç—å—Å—è –∑ —Å–æ–Ω—Ü–µ–º —Ç–∞ —ñ–Ω—Ç–µ–ª–µ–∫—Ç–æ–º.', examples: 'Disney, McDonald\'s' },
                { name: '–°–ø–æ–∫—ñ–π', color: '#6BCB77', icon: 'üåø', desc: '–ë–∞–ª–∞–Ω—Å —ñ –≥–∞—Ä–º–æ–Ω—ñ—è', rationale: '–ó–µ–ª–µ–Ω–∏–π –∑–Ω–∏–∂—É—î —Ç–∏—Å–∫ —Ç–∞ —Å—Ç–≤–æ—Ä—é—î –≤—ñ–¥—á—É—Ç—Ç—è –±–µ–∑–ø–µ–∫–∏. –ö–æ–ª—ñ—Ä –ø—Ä–∏—Ä–æ–¥–∏.', examples: 'Spotify, Starbucks' },
                { name: '–ü—Ä–∏—Å—Ç—Ä–∞—Å—Ç—å', color: '#FF6B6B', icon: '‚ù§Ô∏è', desc: '–õ—é–±–æ–≤ —Ç–∞ —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ñ—Å—Ç—å', rationale: '–ß–µ—Ä–≤–æ–Ω–∏–π –ø—ñ–¥–≤–∏—â—É—î –∞–¥—Ä–µ–Ω–∞–ª—ñ–Ω. –ï–≤–æ–ª—é—Ü—ñ–π–Ω–∏–π —Å–∏–≥–Ω–∞–ª –∑–±—É–¥–∂–µ–Ω–Ω—è.', examples: 'Coca-Cola, Netflix' },
                { name: '–ï–Ω–µ—Ä–≥—ñ—è', color: '#FF8C42', icon: '‚ö°', desc: '–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ç–∞ —Ä—É—Ö', rationale: '–û—Ä–∞–Ω–∂–µ–≤–∏–π –ø–æ—î–¥–Ω—É—î –µ–Ω–µ—Ä–≥—ñ—é —á–µ—Ä–≤–æ–Ω–æ–≥–æ –∑ —Ä–∞–¥—ñ—Å—Ç—é –∂–æ–≤—Ç–æ–≥–æ.', examples: 'Fanta, Nickelodeon' },
                { name: '–¢–∞—î–º–Ω–∏—Ü—è', color: '#6C5CE7', icon: 'üåô', desc: '–ù–µ–∑–≤—ñ–¥–∞–Ω–µ —Ç–∞ —Ü—ñ–∫–∞–≤—ñ—Å—Ç—å', rationale: '–§—ñ–æ–ª–µ—Ç–æ–≤–∏–π —Å—Ç–∏–º—É–ª—é—î —É—è–≤—É. –ê—Å–æ—Ü—ñ—é—î—Ç—å—Å—è –∑ –∫–æ—Ä–æ–ª—ñ–≤—Å—å–∫–æ—é –≤–ª–∞–¥–æ—é.', examples: 'Cadbury, Twitch' },
                { name: '–ú–µ–ª–∞–Ω—Ö–æ–ª—ñ—è', color: '#4A5568', icon: 'üåßÔ∏è', desc: '–°—É–º —Ç–∞ –∑–∞–¥—É–º–ª–∏–≤—ñ—Å—Ç—å', rationale: '–°—ñ—Ä–∏–π —Å—Ç–≤–æ—Ä—é—î –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω—É –∞—Ç–º–æ—Å—Ñ–µ—Ä—É. –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∏–π —Ç–∞ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏–π.', examples: 'Apple' },
                { name: '–ù–∞—Ç—Ö–Ω–µ–Ω–Ω—è', color: '#FF69B4', icon: '‚ú®', desc: '–¢–≤–æ—Ä—á—ñ—Å—Ç—å —Ç–∞ –º—Ä—ñ—ó', rationale: '–†–æ–∂–µ–≤–∏–π –∑–Ω–∏–∂—É—î –∞–≥—Ä–µ—Å—ñ—é. –°–∏–º–≤–æ–ª –Ω—ñ–∂–Ω–æ—Å—Ç—ñ —Ç–∞ —Å–ø—ñ–≤—á—É—Ç—Ç—è.', examples: 'Barbie, Victoria\'s Secret' },
                { name: '–¢—Ä–∏–≤–æ–≥–∞', color: '#8B4513', icon: 'üòü', desc: '–ù–∞–ø—Ä—É–≥–∞ —Ç–∞ —Ç–∏—Å–∫', rationale: '–ö–æ—Ä–∏—á–Ω–µ–≤–∏–π –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤—ñ–¥—á—É—Ç—Ç—è –≤–∞–∂–∫–æ—Å—Ç—ñ —É —Ç–µ–º–Ω–∏—Ö –≤—ñ–¥—Ç—ñ–Ω–∫–∞—Ö.', examples: 'UPS' }
            ],
            moods: [
                { name: '–†–æ–º–∞–Ω—Ç–∏–∫–∞', color: '#FFB6C1', icon: 'üíï', desc: '–ù—ñ–∂–Ω—ñ—Å—Ç—å —Ç–∞ –º—Ä—ñ–π–ª–∏–≤—ñ—Å—Ç—å', film: '–ê–º–µ–ª—ñ (2001)', rationale: '–ú\'—è–∫—ñ —Ä–æ–∂–µ–≤—ñ –≤—ñ–¥—Ç—ñ–Ω–∫–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å —ñ–Ω—Ç–∏–º–Ω—É –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∑ –∑–æ–ª–æ—Ç–∏—Å—Ç–æ—é –Ω–æ—Å—Ç–∞–ª—å–≥—ñ—î—é.' },
                { name: '–î—Ä–∞–º–∞', color: '#8B0000', icon: 'üî•', desc: '–í–∏—Å–æ–∫—ñ —Å—Ç–∞–≤–∫–∏', film: '–•—Ä–µ—â–µ–Ω–∏–π –±–∞—Ç—å–∫–æ (1972)', rationale: '–¢–µ–º–Ω–æ-—á–µ—Ä–≤–æ–Ω–∏–π —Å–∏–º–≤–æ–ª—ñ–∑—É—î –∫—Ä–æ–≤ —Ç–∞ –≤–ª–∞–¥—É. –ö–æ–Ω—Ç—Ä–∞—Å—Ç —Å—Ç–≤–æ—Ä—é—î –Ω–∞–ø—Ä—É–≥—É.' },
                { name: '–ö–æ–º–µ–¥—ñ—è', color: '#FFA500', icon: 'üòÑ', desc: '–í–µ—Å–µ–ª—ñ—Å—Ç—å —Ç–∞ –ø–æ–∑–∏—Ç–∏–≤', film: '–õ–∞-–õ–∞ –õ–µ–Ω–¥ (2016)', rationale: '–ù–∞—Å–∏—á–µ–Ω—ñ –∫–æ–ª—å–æ—Ä–∏ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å —Ä–∞–¥—ñ—Å—Ç—å. –Ø—Å–∫—Ä–∞–≤—ñ—Å—Ç—å - –±–µ–∑—Ç—É—Ä–±–æ—Ç–Ω—ñ—Å—Ç—å.' },
                { name: '–¢—Ä–∏–ª–µ—Ä', color: '#1C1C1C', icon: 'üëª', desc: '–Ü–∑–æ–ª—è—Ü—ñ—è —Ç–∞ –∑–∞–≥—Ä–æ–∑–∞', film: '–°—ñ–º (1995)', rationale: '–î–µ—Å–∞—Ç—É—Ä–∞—Ü—ñ—è —Å—Ç–≤–æ—Ä—é—î –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç. –¢–µ–º–Ω—ñ —Ç–æ–Ω–∏ - –≤—ñ–¥—á—É—Ç—Ç—è –∑–∞–≥—Ä–æ–∑–∏.' },
                { name: '–§–µ–Ω—Ç–µ–∑—ñ', color: '#9370DB', icon: 'üåü', desc: '–ú–∞–≥—ñ—á–Ω—ñ —Å–≤—ñ—Ç–∏', film: '–ê–≤–∞—Ç–∞—Ä (2009)', rationale: '–ù–µ–ø—Ä–∏—Ä–æ–¥–Ω—ñ –Ω–∞—Å–∏—á–µ–Ω—ñ –∫–æ–ª—å–æ—Ä–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å –≤—ñ–¥—á—É—Ç—Ç—è —ñ–Ω—à–æ–≥–æ —Å–≤—ñ—Ç—É.' },
                { name: '–ù—É–∞—Ä', color: '#2F4F4F', icon: '‚òÅÔ∏è', desc: '–¶–∏–Ω—ñ–∑–º —Ç–∞ –¥–≤–æ–∑–Ω–∞—á–Ω—ñ—Å—Ç—å', film: '–ú—ñ—Å—Ç–æ –≥—Ä—ñ—Ö—ñ–≤ (2005)', rationale: '–í–∏—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç. –¢—ñ–Ω—ñ —è–∫ —Å–∏–º–≤–æ–ª –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ—ó –ø—Ä–∞–≤–¥–∏.' },
                { name: '–í–µ—Å—Ç–µ—Ä–Ω', color: '#D2691E', icon: 'ü§†', desc: '–ü—Ä–æ—Å—Ç—ñ—Ä —Ç–∞ –≤–∏–∂–∏–≤–∞–Ω–Ω—è', film: '–•–æ—Ä–æ—à–∏–π, –ø–æ–≥–∞–Ω–∏–π, –∑–ª–∏–π', rationale: '–¢–µ–ø–ª—ñ –∑–µ–º–ª—è–Ω—ñ —Ç–æ–Ω–∏. –í–∏—Ü–≤—ñ–ª—ñ –∫–æ–ª—å–æ—Ä–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å —ñ—Å—Ç–æ—Ä–∏—á–Ω—ñ—Å—Ç—å.' },
                { name: 'Sci-Fi', color: '#00CED1', icon: 'üöÄ', desc: '–§—É—Ç—É—Ä–∏–∑–º', film: '–¢–æ–π, —â–æ –±—ñ–∂–∏—Ç—å –ø–æ –ª–µ–∑—É', rationale: '–•–æ–ª–æ–¥–Ω—ñ —Å–∏–Ω—ñ —Ç–∞ –ø–æ–º–∞—Ä–∞–Ω—á–µ–≤—ñ. –ù–µ–æ–Ω –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π.' }
            ],
            characters: [
                { name: '–ì–µ—Ä–æ–π', color: '#4169E1', icon: '‚≠ê', desc: '–ë–ª–∞–≥–æ—Ä–æ–¥–Ω–∏–π —ñ –Ω–∞–¥—ñ–π–Ω–∏–π', rationale: '–°–∏–Ω—ñ–π - –¥–æ–≤—ñ—Ä–∞ —Ç–∞ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å. –ê—Ä—Ö–µ—Ç–∏–ø –∑–∞—Ö–∏—Å–Ω–∏–∫–∞.' },
                { name: '–õ–∏—Ö–æ–¥—ñ–π', color: '#800080', icon: 'üòà', desc: '–¢–µ–º–Ω–∏–π —ñ –≤–ª–∞–¥–Ω–∏–π', rationale: '–ü—É—Ä–ø—É—Ä - –∫–æ—Ä–æ–ª—ñ–≤—Å—å–∫–∞ –≤–ª–∞–¥–∞ —Ç–∞ –∑–∞—Ä–æ–∑—É–º—ñ–ª—ñ—Å—Ç—å.' },
                { name: '–ù–∞—Å—Ç–∞–≤–Ω–∏–∫', color: '#2E8B57', icon: 'üßô', desc: '–ú—É–¥—Ä–∏–π —ñ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–π', rationale: '–õ—ñ—Å–æ–≤–∏–π –∑–µ–ª–µ–Ω–∏–π - –º—É–¥—Ä—ñ—Å—Ç—å –ø—Ä–∏—Ä–æ–¥–∏ —Ç–∞ —Ä–æ–∫—ñ–≤.' },
                { name: '–ö–æ–º—ñ–∫', color: '#FFD700', icon: 'üòÇ', desc: '–í–µ—Å–µ–ª–∏–π —ñ –∂–∏—Ç—Ç—î—Ä–∞–¥—ñ—Å–Ω–∏–π', rationale: '–ó–æ–ª–æ—Ç–∏–π –ø—Ä–∏–≤–µ—Ä—Ç–∞—î —É–≤–∞–≥—É. –ê—Å–æ—Ü—ñ—é—î—Ç—å—Å—è –∑—ñ —Å–º—ñ—Ö–æ–º.' },
                { name: '–¢—Ä–∞–≥—ñ—á–Ω–∏–π', color: '#483D8B', icon: 'üòî', desc: '–ì–ª–∏–±–æ–∫–∏–π —ñ –º–µ–ª–∞–Ω—Ö–æ–ª—ñ–π–Ω–∏–π', rationale: '–¢–µ–º–Ω–∏–π —Å–∏–Ω—ñ–π - –≥–ª–∏–±–∏–Ω–∞ –µ–º–æ—Ü—ñ–π —Ç–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—è –±–æ—Ä–æ—Ç—å–±–∞.' },
                { name: '–ó–∞–≥–∞–¥–∫–æ–≤–∏–π', color: '#4B0082', icon: 'üé≠', desc: '–¢–∞—î–º–Ω–∏—á–∏–π', rationale: '–Ü–Ω–¥–∏–≥–æ - –º—ñ–∂ —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—é —ñ —É—è–≤–æ—é. –ü—Ä–∏—Ö–æ–≤–∞–Ω—ñ –∑–Ω–∞–Ω–Ω—è.' },
                { name: '–ù–µ–≤–∏–Ω–Ω–∏–π', color: '#F0E68C', icon: 'üå∏', desc: '–°–≤—ñ—Ç–ª–∏–π —ñ –Ω–∞—ó–≤–Ω–∏–π', rationale: '–ü–∞—Å—Ç–µ–ª—å - —á–∏—Å—Ç–æ—Ç–∞, –º–æ–ª–æ–¥—ñ—Å—Ç—å, –ø–æ—á–∞—Ç–æ–∫ –ø–æ–¥–æ—Ä–æ–∂—ñ.' },
                { name: '–ë—É–Ω—Ç–∞—Ä', color: '#DC143C', icon: 'üî•', desc: '–ü—Ä–∏—Å—Ç—Ä–∞—Å–Ω–∏–π —ñ –Ω–µ–ø–æ–∫—ñ—Ä–Ω–∏–π', rationale: '–Ø—Å–∫—Ä–∞–≤–∏–π —á–µ—Ä–≤–æ–Ω–∏–π - —Ä–µ–≤–æ–ª—é—Ü—ñ—è —Ç–∞ –ø—Ä–æ—Ç–µ—Å—Ç.' }
            ]
        };
        const harmonies = {
            complementary: { name: '–ö–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∞', desc: '–ü—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ –∫–æ–ª—å–æ—Ä–∏. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –¥–ª—è –¥—Ä–∞–º–∏.', example: '–¢—Ä–æ–Ω: –°–ø–∞–¥–æ–∫', roles: ['60% –ë–∞–∑–∞', '40% –ö–æ–Ω—Ç—Ä–∞—Å—Ç'], usage: '–ë–∞–∑–∞ –¥–ª—è —Ñ–æ–Ω—É, –∫–æ–Ω—Ç—Ä–∞—Å—Ç –¥–ª—è –∫–ª—é—á–æ–≤–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.' },
            analogous: { name: '–ê–Ω–∞–ª–æ–≥–æ–≤–∞', desc: '–°—É—Å—ñ–¥–Ω—ñ –∫–æ–ª—å–æ—Ä–∏. –ì–∞—Ä–º–æ–Ω—ñ–π–Ω–∞ —Å–ø–æ–∫—ñ–π–Ω–∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞.', example: '–í–µ–ª–∏–∫–∏–π –≥–æ—Ç–µ–ª—å –ë—É–¥–∞–ø–µ—à—Ç', roles: ['60% –î–æ–º—ñ–Ω–∞–Ω—Ç–Ω–∏–π', '30% –ü—ñ–¥—Ç—Ä–∏–º–∫–∞', '10% –ê–∫—Ü–µ–Ω—Ç'], usage: '–î–ª—è —Ñ–æ–Ω—ñ–≤ —Ç–∞ –ø–ª–∞–≤–Ω–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤.' },
            triadic: { name: '–¢—Ä—ñ–∞–¥–∏—á–Ω–∞', desc: '–†—ñ–≤–Ω–æ–≤—ñ–¥–¥–∞–ª–µ–Ω—ñ –∫–æ–ª—å–æ—Ä–∏. –ó–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–∞ –∂–∏–≤–∞ –ø–∞–ª—ñ—Ç—Ä–∞.', example: '–î–∂–æ–∫–µ—Ä (2019)', roles: ['60% –û—Å–Ω–æ–≤–Ω–∏–π', '30% –í—Ç–æ—Ä–∏–Ω–Ω–∏–π', '10% –ê–∫—Ü–µ–Ω—Ç'], usage: '–ö–æ–∂–µ–Ω –∫–æ–ª—ñ—Ä –º–∞—î –æ–∫—Ä–µ–º—É —Ñ—É–Ω–∫—Ü—ñ—é.' },
            'split-complementary': { name: '–†–æ–∑—â–µ–ø–ª–µ–Ω–∞', desc: '–ë–∞–∑–∞ –ø–ª—é—Å –¥–≤–∞ —Å—É—Å—ñ–¥–∏ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ–≥–æ. –¶—ñ–∫–∞–≤–∞ —Ç–∞ –º–µ–Ω—à –Ω–∞–ø—Ä—É–∂–µ–Ω–∞.', example: '–í–æ–ª–æ–¥–∞—Ä –ø–µ—Ä—Å–Ω—ñ–≤', roles: ['60% –ë–∞–∑–∞', '25% –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 1', '15% –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 2'], usage: '–î–ª—è –±–∞–≥–∞—Ç–∏—Ö –∫–æ–º–ø–æ–∑–∏—Ü—ñ–π –±–µ–∑ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.' },
            tetradic: { name: '–¢–µ—Ç—Ä–∞–¥–∏—á–Ω–∞', desc: '–î–≤—ñ –ø–∞—Ä–∏ –∫–æ–ª—å–æ—Ä—ñ–≤. –ù–∞–π–±–∞–≥–∞—Ç—à–∞ —Å—Ö–µ–º–∞.', example: '–í—ñ–¥–Ω–µ—Å–µ–Ω—ñ –≤—ñ—Ç—Ä–æ–º', roles: ['40% –û—Å–Ω–æ–≤–Ω–∏–π', '30% –í—Ç–æ—Ä–∏–Ω–Ω–∏–π', '20% –¢—Ä–µ—Ç–∏–Ω–Ω–∏–π', '10% –ê–∫—Ü–µ–Ω—Ç'], usage: '–î–ª—è –µ–ø—ñ—á–Ω–∏—Ö —Å–∫–ª–∞–¥–Ω–∏—Ö —Å—Ü–µ–Ω.' },
            monochromatic: { name: '–ú–æ–Ω–æ—Ö—Ä–æ–º–∞—Ç–∏—á–Ω–∞', desc: '–í—ñ–¥—Ç—ñ–Ω–∫–∏ –æ–¥–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É. –í–∏—Ç–æ–Ω—á–µ–Ω–∞ —î–¥–Ω—ñ—Å—Ç—å.', example: '–ú–∞—Ç—Ä–∏—Ü—è', roles: ['60% –°–µ—Ä–µ–¥–Ω—ñ–π', '30% –¢–µ–º–Ω–∏–π', '10% –°–≤—ñ—Ç–ª–∏–π'], usage: '–î–ª—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–≥–æ –Ω—É–∞—Ä—É —Ç–∞ –¥—Ä–∞–º–∏.' }
        };

        // --- Color Conversion Utilities (Copied and completed from the initial code) ---
        const hexToHSL = (hex) => {
            const r = parseInt(hex.slice(1, 3), 16) / 255;
            const g = parseInt(hex.slice(3, 5), 16) / 255;
            const b = parseInt(hex.slice(5, 7), 16) / 255;
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }
            return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };
        };
        const hslToHex = (h, s, l) => {
            l /= 100;
            s /= 100;
            const a = s * Math.min(l, 1 - l);
            const f = n => {
                const k = (n + h / 30) % 12;
                const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                return Math.round(255 * color).toString(16).padStart(2, '0');
            };
            return '#' + f(0) + f(8) + f(4);
        };
        // --- Harmony Generation Logic (Completed) ---
        const generateHarmony = (hex, type) => {
            const hsl = hexToHSL(hex);
            const h = hsl.h;
            const s = hsl.s;
            const l = hsl.l;
            const colors = [hex];

            switch (type) {
                case 'complementary':
                    colors.push(hslToHex((h + 180) % 360, s, l));
                    break;
                case 'triadic':
                    colors.push(hslToHex((h + 120) % 360, s, l));
                    colors.push(hslToHex((h + 240) % 360, s, l));
                    break;
                case 'analogous':
                    // Central color (base) plus two neighbors
                    colors.push(hslToHex((h + 30) % 360, s, l));
                    colors.push(hslToHex((h - 30 + 360) % 360, s, l));
                    break;
                case 'split-complementary':
                    const comp = (h + 180) % 360;
                    colors.push(hslToHex((comp + 30) % 360, s, l));
                    colors.push(hslToHex((comp - 30 + 360) % 360, s, l));
                    break;
                case 'tetradic':
                    colors.push(hslToHex((h + 90) % 360, s, l));
                    colors.push(hslToHex((h + 180) % 360, s, l));
                    colors.push(hslToHex((h + 270) % 360, s, l));
                    break;
                case 'monochromatic':
                    // Base color + two lighter tints + one darker shade
                    colors.push(hslToHex(h, s, Math.min(l + 25, 95))); // Lighter 1
                    colors.push(hslToHex(h, s, Math.min(l + 40, 95))); // Lighter 2
                    colors.push(hslToHex(h, s, Math.max(l - 25, 10))); // Darker 1
                    break;
            }
            // Ensure maximum 4 colors are returned for clean display
            return colors.slice(0, 4); 
        };

        // --- WCAG Accessibility (Contrast) Logic ---
        // Calculates relative luminance (0 to 1)
        const getLuminance = (hex) => {
            let r = parseInt(hex.slice(1, 3), 16) / 255;
            let g = parseInt(hex.slice(3, 5), 16) / 255;
            let b = parseInt(hex.slice(5, 7), 16) / 255;

            const correct = (c) => {
                return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
            };

            const R = correct(r);
            const G = correct(g);
            const B = correct(b);

            return 0.2126 * R + 0.7152 * G + 0.0722 * B;
        };
        // Calculates contrast ratio (1:1 to 21:1)
        const getContrastRatio = (color1, color2) => {
            const L1 = getLuminance(color1);
            const L2 = getLuminance(color2);
            const ratio = (Math.max(L1, L2) + 0.05) / (Math.min(L1, L2) + 0.05);
            return ratio.toFixed(2);
        };
        
        // --- Global Color Constants (FIX for ReferenceError) ---
        const darkText = '#1A202C'; // Main background color for high-contrast text on light elements
        const lightText = '#FFFFFF'; // Main text color for high-contrast text on dark elements

        // --- UI Rendering Functions ---

        // Toast Notification
        const showToast = (message) => {
            const toastEl = document.getElementById('toast');
            document.getElementById('toast-message').textContent = message;
                        
            // Show toast
            toastEl.classList.remove('translate-y-32', 'opacity-0');
            toastEl.classList.add('translate-y-0', 'opacity-100');

            // Hide toast after 3 seconds
            setTimeout(() => {
                toastEl.classList.add('translate-y-32', 'opacity-0');
                toastEl.classList.remove('translate-y-0', 'opacity-100');
            }, 3000);
        };

        // Copy utility
        const copyToClipboard = (text) => {
            // Using a fallback for environments where navigator.clipboard.writeText is restricted
            try {
                const el = document.createElement('textarea');
                el.value = text;
                el.setAttribute('readonly', '');
                el.style.position = 'absolute';
                el.style.left = '-9999px';
                document.body.appendChild(el);
                document.execCommand('copy');
                document.body.removeChild(el);
                showToast(`‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ: ${text}`);
            } catch (err) {
                showToast('‚ùå –ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è');
            }
        };

        // Renders Category Tabs
        const renderCategories = () => {
            const container = document.getElementById('categories');
            container.innerHTML = Object.entries(data.categories).map(([key, value]) => {
                const isSelected = key === state.category;
                return `
                    <button 
                        data-category="${key}"
                        class="category-btn text-white text-lg font-semibold px-6 py-3 rounded-full transition-all duration-200 
                        ${isSelected ? 'bg-white/30 backdrop-blur-sm shadow-xl btn-primary' : 'bg-transparent hover:bg-white/10'}"
                    >
                        ${value.name}
                    </button>
                `;
            }).join('');

            document.querySelectorAll('.category-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const newCategory = e.currentTarget.getAttribute('data-category');
                    const firstItem = data[newCategory][0];
                    setState({
                        category: newCategory,
                        selectedItem: firstItem.name,
                        baseColor: firstItem.color
                    });
                });
            });
        };

        // Renders Selectable Color Items (Emotions, Moods, Characters)
        const renderColorItems = () => {
            const container = document.getElementById('color-items');
            const itemsTitle = document.getElementById('items-title');
            const currentData = data[state.category];
            const title = data.categories[state.category].title;
            
            itemsTitle.textContent = title;

            container.innerHTML = currentData.map(item => {
                const isSelected = item.name === state.selectedItem;
                const borderColor = isSelected ? state.baseColor : 'transparent';
                                
                return `
                    <div 
                        data-color="${item.color}"
                        data-name="${item.name}"
                        class="color-card rounded-2xl p-4 text-center cursor-pointer flex flex-col items-center justify-center h-32" 
                        style="background-color: ${item.color}; border: 4px solid ${borderColor};"
                    >
                        <span class="text-4xl" role="img" aria-label="${item.name}">${item.icon}</span>
                        <p class="font-bold text-sm mt-1 text-gray-900 drop-shadow-lg" style="color: ${getLuminance(item.color) > 0.4 ? darkText : lightText};">
                            ${item.name}
                        </p>
                    </div>
                `;
            }).join('');

            document.querySelectorAll('.color-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    const color = e.currentTarget.getAttribute('data-color');
                    const name = e.currentTarget.getAttribute('data-name');
                    setState({ baseColor: color, selectedItem: name });
                });
            });
        };

        // Renders Harmony Type Buttons
        const renderHarmonyTypes = () => {
            const container = document.getElementById('harmony-types');
            container.innerHTML = Object.entries(harmonies).map(([key, value]) => {
                const isSelected = key === state.harmonyType;
                return `
                    <button 
                        data-harmony="${key}"
                        class="harmony-type-btn w-full text-white text-base font-medium px-4 py-3 rounded-xl border border-white/20 transition-all duration-200 
                        ${isSelected ? 'selected btn-primary' : 'bg-white/10 hover:bg-white/20'}"
                    >
                        ${value.name}
                    </button>
                `;
            }).join('');

            document.querySelectorAll('.harmony-type-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const newHarmony = e.currentTarget.getAttribute('data-harmony');
                    setState({ harmonyType: newHarmony });
                });
            });
        };

        // Renders the Base Color Display and Controls
        const renderBaseColorDisplay = () => {
            const { baseColor } = state;
            const display = document.getElementById('base-color-display');
            const colorPicker = document.getElementById('color-picker');
            const colorHex = document.getElementById('color-hex');
            const colorHsl = document.getElementById('color-hsl');
            const colorInfo = document.getElementById('color-info');
            const hsl = hexToHSL(baseColor);
                        
            // Update Visuals
            display.style.backgroundColor = baseColor;
            colorPicker.value = baseColor;
            colorHex.textContent = baseColor.toUpperCase();
            colorHsl.textContent = `HSL(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;

            // Setup click to copy for the HEX display
            colorHex.onclick = () => copyToClipboard(baseColor.toUpperCase());

            // Get current item data for hover info
            const currentItem = data[state.category].find(item => item.name === state.selectedItem);
            if (currentItem) {
                const infoHtml = `
                    <p>–ù–∞–∑–≤–∞: <span class="font-bold">${currentItem.name}</span></p>
                    <p>${currentItem.desc}</p>
                    ${currentItem.film ? `<p>–ö—ñ–Ω–æ-–ø—Ä–∏–∫–ª–∞–¥: ${currentItem.film}</p>` : ''}
                    ${currentItem.examples ? `<p>–ë—Ä–µ–Ω–¥–∏: ${currentItem.examples}</p>` : ''}
                `;
                colorInfo.innerHTML = infoHtml;
            } else { 
                 colorInfo.innerHTML = `<p class="font-bold">–í–ª–∞—Å–Ω–∏–π –∫–æ–ª—ñ—Ä</p>`;
            }
        };

        // Renders the Harmony Palette (colors + usage)
        const renderHarmonyPalette = () => {
            const container = document.getElementById('harmony-palette');
            const palette = generateHarmony(state.baseColor, state.harmonyType);

            container.innerHTML = palette.map((color, index) => {
                // Determine text color for readability
                const textColor = getLuminance(color) > 0.4 ? darkText : lightText; 
                const role = harmonies[state.harmonyType].roles[index] || '–ê–∫—Ü–µ–Ω—Ç';

                return `
                    <div 
                        data-color="${color}" 
                        class="color-card rounded-2xl h-40 flex flex-col justify-end p-4 cursor-pointer relative" 
                        style="background-color: ${color}; color: ${textColor};"
                    >
                        <div class="z-20">
                            <p class="font-mono font-black text-xl drop-shadow-lg">${color.toUpperCase()}</p>
                            <span class="role-badge" style="background: ${textColor}; color: ${color};">${role}</span>
                        </div>
                    </div>
                `;
            }).join('');

            // Attach copy listener to palette cards
            document.querySelectorAll('#harmony-palette .color-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    const color = e.currentTarget.getAttribute('data-color');
                    copyToClipboard(color.toUpperCase());
                });
            });
        };

        // Renders the Usage Guide (60-30-10)
        const renderUsageGuide = () => {
            const usageContainer = document.getElementById('usage-guide');
            const desc = document.getElementById('harmony-description');
            const harmonyData = harmonies[state.harmonyType];

            desc.textContent = harmonyData.desc + ' ' + harmonyData.usage;

            const total = harmonyData.roles.length === 4 ? 100 : 100; // Total percentage

            // Custom logic for 60-30-10 based on role names
            const rolePercentages = {
                '60% –û—Å–Ω–æ–≤–Ω–∏–π': 60, '60% –ë–∞–∑–∞': 60, '60% –î–æ–º—ñ–Ω–∞–Ω—Ç–Ω–∏–π': 60, '60% –°–µ—Ä–µ–¥–Ω—ñ–π': 60,
                '40% –û—Å–Ω–æ–≤–Ω–∏–π': 40,
                '30% –í—Ç–æ—Ä–∏–Ω–Ω–∏–π': 30, '30% –ü—ñ–¥—Ç—Ä–∏–º–∫–∞': 30, '30% –¢–µ–º–Ω–∏–π': 30,
                '25% –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 1': 25,
                '20% –¢—Ä–µ—Ç–∏–Ω–Ω–∏–π': 20,
                '15% –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 2': 15,
                '10% –ê–∫—Ü–µ–Ω—Ç': 10, '10% –°–≤—ñ—Ç–ª–∏–π': 10,
                '40% –ö–æ–Ω—Ç—Ä–∞—Å—Ç': 40
            };

            // Combine roles with their calculated colors
            const palette = generateHarmony(state.baseColor, state.harmonyType);
            
            let html = '';
            let currentPaletteIndex = 0;

            harmonyData.roles.forEach(role => {
                let percentage = rolePercentages[role] || 0;
                let color = palette[currentPaletteIndex] || '#fff'; // Use color from palette

                // Special handling for Tetradic/Split/Complementary where roles might be combined or exceed 4
                if (role.includes('–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 1') && state.harmonyType === 'split-complementary') {
                    // Split Complementary: 60% Base, 25% Supp 1, 15% Supp 2. (Uses color[1] and color[2])
                    color = palette[1];
                } else if (role.includes('–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 2') && state.harmonyType === 'split-complementary') {
                    color = palette[2];
                } else if (role.includes('–í—Ç–æ—Ä–∏–Ω–Ω–∏–π') && state.harmonyType === 'tetradic') {
                    // In Tetradic, the 30% might represent the second color of the palette, but it's often described as a combination of two. We'll use the next color in the palette for visualization.
                    color = palette[1];
                } else if (role.includes('–¢—Ä–µ—Ç–∏–Ω–Ω–∏–π') && state.harmonyType === 'tetradic') {
                    color = palette[2];
                } else if (role.includes('–ê–∫—Ü–µ–Ω—Ç') && state.harmonyType === 'tetradic') {
                    color = palette[3];
                } else if (role.includes('–ê–∫—Ü–µ–Ω—Ç') && state.harmonyType === 'triadic') {
                    color = palette[2];
                } else if (role.includes('–ê–∫—Ü–µ–Ω—Ç') && state.harmonyType === 'analogous') {
                    color = palette[2];
                } else if (role.includes('–ö–æ–Ω—Ç—Ä–∞—Å—Ç') && state.harmonyType === 'complementary') {
                    color = palette[1];
                } else if (role.includes('–°–µ—Ä–µ–¥–Ω—ñ–π') && state.harmonyType === 'monochromatic') {
                    color = palette[0];
                } else if (role.includes('–¢–µ–º–Ω–∏–π') && state.harmonyType === 'monochromatic') {
                    color = palette[3];
                } else if (role.includes('–°–≤—ñ—Ç–ª–∏–π') && state.harmonyType === 'monochromatic') {
                    color = palette[2];
                } else if (currentPaletteIndex < palette.length) {
                    color = palette[currentPaletteIndex];
                }

                if (percentage > 0) {
                     html += `
                        <div class="flex items-center space-x-4">
                            <span class="font-bold text-lg w-16 text-white/90">${percentage}%</span>
                            <div class="flex-grow">
                                <p class="text-white font-medium">${role}</p>
                                <div class="usage-bar">
                                    <div class="usage-fill" style="width: ${percentage}%; background-color: ${color};"></div>
                                </div>
                            </div>
                        </div>
                    `;
                }

                // Increment index only if it's a primary visual role (not split)
                if (!role.includes('–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 2') && percentage > 0) {
                     currentPaletteIndex++;
                }

            });

            usageContainer.innerHTML = html;
        };


        // Renders the Accessibility Panel
        const renderAccessibility = () => {
            const container = document.getElementById('accessibility-info');
            const palette = generateHarmony(state.baseColor, state.harmonyType);
            const base = state.baseColor;
            
            // Standard text colors for comparison
            const white = '#FFFFFF';
            const black = '#000000';
            const textLuminance = getLuminance(white); // Using white text as the primary text color

            let accessibilityHtml = `
                <div class="space-y-4">
                    <p class="text-white/80">–û—Ü—ñ–Ω–∫–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ WCAG (Web Content Accessibility Guidelines).</p>
                    <div class="p-4 rounded-xl bg-white/5 border border-white/10">
                        <h4 class="text-white font-bold mb-3">–ë–∞–∑–æ–≤–∏–π –∫–æ–ª—ñ—Ä (${base.toUpperCase()})</h4>
                        <div class="grid grid-cols-2 gap-4 text-sm font-medium">
                            ${palette.map((color, index) => {
                                const contrastWithBase = getContrastRatio(base, color);
                                const isAccessible = contrastWithBase >= 3.0; // AA (Large Text)

                                // Find the role for this color
                                const role = harmonies[state.harmonyType].roles[index] || '–ê–∫—Ü–µ–Ω—Ç';

                                return `
                                    <div class="p-2 rounded-lg" style="background-color: ${color};">
                                        <p class="font-bold" style="color: ${getLuminance(color) > 0.4 ? darkText : lightText};">
                                            ${role}
                                        </p>
                                        <p style="color: ${getLuminance(color) > 0.4 ? darkText : lightText};">–ö–æ–Ω—Ç—Ä–∞—Å—Ç –∑ –ë–∞–∑–æ–≤–∏–º: ${contrastWithBase}:1</p>
                                        <p class="font-bold ${isAccessible ? 'text-green-800' : 'text-red-800'}" style="color: ${isAccessible ? (getLuminance(color) > 0.4 ? '#059669' : '#10B981') : (getLuminance(color) > 0.4 ? '#B91C1C' : '#F87171')};">
                                            ${isAccessible ? '‚úÖ OK (AA-Large)' : '‚ùå FAIL'}
                                        </p>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    <div class="p-4 rounded-xl bg-white/5 border border-white/10">
                        <h4 class="text-white font-bold mb-3">–ö–æ–Ω—Ç—Ä–∞—Å—Ç –∑ –±—ñ–ª–∏–º —Ç–µ–∫—Å—Ç–æ–º (#FFFFFF)</h4>
                        <ul class="space-y-2 text-sm text-white/90">
                            ${palette.map(color => {
                                const contrast = getContrastRatio(color, white);
                                const isAccessibleAA = contrast >= 4.5;
                                const isAccessibleAAA = contrast >= 7.0;

                                let status;
                                if (isAccessibleAAA) {
                                    status = '‚úÖ AAA (–í—ñ–¥–º—ñ–Ω–Ω–æ)';
                                } else if (isAccessibleAA) {
                                    status = '‚òëÔ∏è AA (–î–æ–±—Ä–µ)';
                                } else {
                                    status = '‚ùå FAIL (–ü–æ–≥–∞–Ω–æ)';
                                }

                                return `
                                    <li class="flex justify-between items-center border-b border-white/10 pb-1">
                                        <span class="font-mono text-xs" style="color: ${color};">${color.toUpperCase()}</span>
                                        <span class="font-semibold">${contrast}:1</span>
                                        <span class="${isAccessibleAAA ? 'text-green-500' : (isAccessibleAA ? 'text-yellow-500' : 'text-red-500')}">${status}</span>
                                    </li>
                                `;
                            }).join('')}
                        </ul>
                    </div>
                </div>
            `;
            container.innerHTML = accessibilityHtml;
        };


        // Renders Psychology Info
        const renderPsychology = () => {
             const container = document.getElementById('psychology-info');
             const currentItem = data[state.category].find(item => item.name === state.selectedItem);

             if (currentItem) {
                 container.innerHTML = `
                     <p class="font-bold mb-2">${currentItem.name}: ${currentItem.desc}</p>
                     <p>${currentItem.rationale}</p>
                 `;
             }
        };

        // Renders Simple Design Examples
        const renderDesignExamples = () => {
            const container = document.getElementById('design-examples');
            const palette = generateHarmony(state.baseColor, state.harmonyType);
            const baseColor = state.baseColor;
            const accentColor = palette.length > 3 ? palette[3] : (palette.length > 1 ? palette[1] : baseColor);
            const secondaryColor = palette.length > 1 ? palette[1] : baseColor;
            // Removed local definitions for darkText and lightText, now using global constants.

            container.innerHTML = `
                <!-- UI Card Example -->
                <div class="rounded-xl p-4 h-48 flex flex-col justify-between shadow-lg" style="background-color: ${secondaryColor}; color: ${getLuminance(secondaryColor) > 0.4 ? darkText : lightText};">
                    <p class="font-bold text-xl">–í—Ç–æ—Ä–∏–Ω–Ω–∏–π –ë–ª–æ–∫</p>
                    <p class="text-sm">–ö–æ–Ω—Ç–µ–Ω—Ç–Ω–∞ –∫–∞—Ä—Ç–∫–∞. 30% –ø—Ä–æ—Å—Ç–æ—Ä—É.</p>
                    <button class="px-3 py-2 rounded-lg font-bold text-sm shadow-md" style="background-color: ${accentColor}; color: ${getLuminance(accentColor) > 0.4 ? darkText : lightText};">
                        –ê–∫—Ü–µ–Ω—Ç–Ω–∞ –ö–Ω–æ–ø–∫–∞ (10%)
                    </button>
                </div>

                <!-- Text Highlight Example -->
                <div class="rounded-xl p-4 h-48 flex flex-col justify-center items-center shadow-lg" style="background-color: ${baseColor}; color: ${getLuminance(baseColor) > 0.4 ? darkText : lightText};">
                    <p class="text-3xl font-black mb-2">60%</p>
                    <p class="text-xl">–û—Å–Ω–æ–≤–Ω–∏–π —Ñ–æ–Ω</p>
                    <span class="text-base" style="color: ${accentColor};">–ö–ª—é—á–æ–≤–µ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É</span>
                </div>

                <!-- Dark UI Example -->
                <div class="rounded-xl p-4 h-48 flex flex-col justify-center items-center shadow-lg bg-gray-900 text-white">
                    <p class="text-3xl font-black mb-2" style="color: ${accentColor};">CTA</p>
                    <p class="text-sm text-gray-400">–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É –∑ —Ç–µ–º–Ω–∏–º —Ñ–æ–Ω–æ–º</p>
                    <div class="flex space-x-2 mt-2">
                        <span class="font-bold text-sm" style="color: ${secondaryColor};">Secondary</span>
                        <span class="font-bold text-sm" style="color: ${baseColor};">Primary</span>
                    </div>
                </div>
            `;
        };

        // Main render function
        const renderApp = () => {
            renderCategories();
            renderColorItems();
            renderHarmonyTypes();
            renderBaseColorDisplay();
            renderHarmonyPalette();
            renderUsageGuide();
            renderAccessibility();
            renderPsychology();
            renderDesignExamples();
        };

        // --- Event Listeners and Initial Load ---
        document.getElementById('color-picker').addEventListener('input', (e) => {
            setState({ baseColor: e.target.value, selectedItem: null });
        });
        document.getElementById('base-color-display').addEventListener('click', () => {
            document.getElementById('color-picker').click();
        });


        // Initial load
        document.addEventListener('DOMContentLoaded', renderApp);

    </script>
</body>
</html>
